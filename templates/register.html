{% extends "base.html" %}

{% block title %}ðŸŽ¾ Coach Registration{% endblock %}

{% block body_class %}register-page{% endblock %}

{% block container_class %}container min-vh-100 d-flex align-items-center justify-content-center py-5{% endblock %}

{% block content %}
  <div class="w-100" style="max-width: 450px;">
    <div class="register-card tennis-card mx-auto">
      <!-- PWA Install Prompt -->
      <div class="install-prompt" id="installPrompt">
        ðŸ“± Install Tennis Toolbox as an app for quick access!
        <button id="installButton">Install</button>
        <button id="dismissButton">Later</button>
      </div>
      
      <h3 class="text-success text-center mb-4">ðŸŽ¾ Coach Sign-Up</h3>
      
      <!-- Registration Form -->
      <form method="POST" action="/register">
        <div class="mb-3">
          <label class="form-label">Username</label>
          <input type="text" name="username" class="form-control" required placeholder="e.g. coachjamie">
        </div>
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input type="email" name="email" class="form-control" required placeholder="e.g. jamie@email.com">
        </div>
        <div class="mb-3">
          <label class="form-label">Location</label>
          <input type="text" name="postcode" class="form-control" required placeholder="e.g. Wimbledon">
        </div>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input type="password" name="password" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Create Account</button>
      </form>
      
      <p class="text-center mt-3">
        Already have an account? <a href="/login" class="text-link">Login here</a>
      </p>
    </div>
  </div>
{% endblock %}

{% block footer %}{% endblock %}

{% block extra_js %}
<script>
  // PWA Installation Script
  let deferredPrompt;
  const installPrompt = document.getElementById('installPrompt');
  const installButton = document.getElementById('installButton');
  const dismissButton = document.getElementById('dismissButton');
  
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installPrompt.style.display = 'block';
  });
  
  installButton.addEventListener('click', async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      console.log(`User response to the install prompt: ${outcome}`);
      deferredPrompt = null;
      installPrompt.style.display = 'none';
    }
  });
  
  dismissButton.addEventListener('click', () => {
    installPrompt.style.display = 'none';
  });
  
  // Hide prompt if already installed
  window.addEventListener('appinstalled', () => {
    installPrompt.style.display = 'none';
    deferredPrompt = null;
  });
  
  // Existing timeout script for alerts
  setTimeout(() => {
    document.querySelectorAll('.alert').forEach(alert => {
      alert.classList.remove('show');
      alert.classList.add('fade');
      setTimeout(() => alert.remove(), 500);
    });
  }, 5000);
</script>
{% endblock %}